(function(){CodeMirror.extendMode("css",{commentStart:"/*",commentEnd:"*/",newlineAfterToken:function(e,t){return/^[;{}]$/.test(t)}});CodeMirror.extendMode("javascript",{commentStart:"/*",commentEnd:"*/",newlineAfterToken:function(e,t,n,r){if(this.jsonMode){return/^[\[,{]$/.test(t)||/^}/.test(n)}else{if(t==";"&&r.lexical&&r.lexical.type==")"){return false}return/^[;{}]$/.test(t)&&!/^;/.test(n)}}});CodeMirror.extendMode("xml",{commentStart:"\x3c!--",commentEnd:"--\x3e",newlineAfterToken:function(e,t,n){return e=="tag"&&/>$/.test(t)||/^</.test(n)}});CodeMirror.defineExtension("commentRange",function(r,o,i){var a=this,s=CodeMirror.innerMode(a.getMode(),a.getTokenAt(o).state).mode;a.operation(function(){if(r){a.replaceRange(s.commentEnd,i);a.replaceRange(s.commentStart,o);if(o.line==i.line&&o.ch==i.ch){a.setCursor(o.line,o.ch+s.commentStart.length)}}else{var e=a.getRange(o,i);var t=e.indexOf(s.commentStart);var n=e.lastIndexOf(s.commentEnd);if(t>-1&&n>-1&&n>t){e=e.substr(0,t)+e.substring(t+s.commentStart.length,n)+e.substr(n+s.commentEnd.length)}a.replaceRange(e,o,i)}})});CodeMirror.defineExtension("autoIndentRange",function(t,n){var r=this;this.operation(function(){for(var e=t.line;e<=n.line;e++){r.indentLine(e,"smart")}})});CodeMirror.defineExtension("autoFormatRange",function(n,r){var o=this;var e=o.getMode(),t=o.getRange(n,r).split("\n");var i=CodeMirror.copyState(e,o.getTokenAt(n).state);var a=o.getOption("tabSize");var s="",c=0,d=n.ch==0;function l(){s+="\n";d=true;++c}for(var f=0;f<t.length;++f){var m=new CodeMirror.StringStream(t[f],a);while(!m.eol()){var g=CodeMirror.innerMode(e,i);var u=e.token(m,i),M=m.current();m.start=m.pos;if(!d||/\S/.test(M)){s+=M;d=false}if(!d&&g.mode.newlineAfterToken&&g.mode.newlineAfterToken(u,M,m.string.slice(m.pos)||t[f+1]||"",g.state)){l()}}if(!m.pos&&e.blankLine){e.blankLine(i)}if(!d){l()}}o.operation(function(){o.replaceRange(s,n,r);for(var e=n.line+1,t=n.line+c;e<=t;++e){o.indentLine(e,"smart")}o.setSelection(n,o.getCursor(false))})})})();