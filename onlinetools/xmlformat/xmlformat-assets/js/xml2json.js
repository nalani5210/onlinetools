function xml2json(e,n,l){l="undefined"===typeof l?!0:!!l;var a=!!n.length,d={toObj:function(e){var n={};if(1==e.nodeType){if(l&&e.attributes.length)for(var t=0;t<e.attributes.length;t++)n["@"+e.attributes[t].nodeName]=(e.attributes[t].nodeValue||"").toString();if(e.firstChild){for(var i=t=0,o=!1,r=e.firstChild;r;r=r.nextSibling)1==r.nodeType?o=!0:3==r.nodeType&&r.nodeValue.match(/[^ \f\n\r\t\v]/)?t++:4==r.nodeType&&i++;if(o)if(2>t&&2>i)for(d.removeWhite(e),r=e.firstChild;r;r=r.nextSibling)3==r.nodeType?n["#text"]=d.escape(r.nodeValue):4==r.nodeType?n["#cdata"]=d.escape(r.nodeValue):n[r.nodeName]?n[r.nodeName]instanceof Array?n[r.nodeName][n[r.nodeName].length]=d.toObj(r):n[r.nodeName]=[n[r.nodeName],d.toObj(r)]:n[r.nodeName]=d.toObj(r);else e.attributes.length?n["#text"]=d.escape(d.innerXml(e)):n=d.escape(d.innerXml(e));else if(t)l&&e.attributes.length?n["#text"]=d.escape(d.innerXml(e)):n=d.escape(d.innerXml(e));else if(i)if(1<i)n=d.escape(d.innerXml(e));else for(r=e.firstChild;r;r=r.nextSibling)n["#cdata"]=d.escape(r.nodeValue)}e.attributes.length||e.firstChild||(n=null)}else 9==e.nodeType?n=d.toObj(e.documentElement):alert("unhandled node type: "+e.nodeType);return n},toJson:function(e,n,t){var i=n?'"'+n+'"':"";if(e instanceof Array){for(var o=0,r=e.length;o<r;o++)e[o]=d.toJson(e[o],"",t+"\t");i+=(n?a?": [":":[":"[")+(1<e.length?"\n"+t+"\t"+e.join(",\n"+t+"\t")+"\n"+t:e.join(""))+"]"}else if(null==e)i+=(n&&":")+"null";else if("object"==typeof e){o=[];for(r in e)o[o.length]=d.toJson(e[r],r,t+"\t");i+=(n?a?": {":":{":"{")+(1<=o.length?"\n"+t+"\t"+o.join(",\n"+t+"\t")+"\n"+t:o.join(""))+"}"}else i="string"==typeof e?i+((n&&(a?": ":":"))+'"'+e.toString()+'"'):i+((n&&(a?": ":":"))+e.toString());return i},innerXml:function(e){var n="";if("innerHTML"in e)n=e.innerHTML;else{var i=function(e){var n="";if(1==e.nodeType){n+="<"+e.nodeName;for(var t=0;t<e.attributes.length;t++)n+=" "+e.attributes[t].nodeName+'="'+(e.attributes[t].nodeValue||"").toString()+'"';if(e.firstChild){n+=">";for(t=e.firstChild;t;t=t.nextSibling)n+=i(t);n+="</"+e.nodeName+">"}else n+="/>"}else 3==e.nodeType?n+=e.nodeValue:4==e.nodeType&&(n+="<![CDATA["+e.nodeValue+"]]>");return n};for(e=e.firstChild;e;e=e.nextSibling)n+=i(e)}return n},escape:function(e){return e.replace(/[\\]/g,"\\\\").replace(/["]/g,'\\"').replace(/[\n]/g,"\\n").replace(/[\r]/g,"\\r")},removeWhite:function(e){e.normalize();for(var n=e.firstChild;n;)if(3==n.nodeType)if(n.nodeValue.match(/[^ \f\n\r\t\v]/))n=n.nextSibling;else{var t=n.nextSibling;e.removeChild(n);n=t}else 1==n.nodeType&&d.removeWhite(n),n=n.nextSibling;return e}};9==e.nodeType&&(e=e.documentElement);e=d.toJson(d.toObj(d.removeWhite(e)),e.nodeName,"\t");return"{"+(a?"\n":"")+n+(n?e.replace(/\t/g,n):e.replace(/\t|\n/g,""))+(a?"\n":"")+"}"}