(function(g){g.fn.linedtextarea=function(e){var o=g.extend({},g.fn.linedtextarea.defaults,e);var f=function(e,i,t){while(e.height()-i<=0){if(t==o.selectedLine)e.append("<div class='lineno lineselect'>"+t+"</div>");else e.append("<div class='lineno'>"+t+"</div>");t++}return t};return this.each(function(){var s=1;var e=g(this);e.attr("wrap","off");e.css({resize:"none"});var i=e.outerWidth();e.wrap("<div class='linedtextarea'></div>");var t=e.parent().wrap("<div class='linedwrap' style='width:"+i+"px'></div>");var n=t.parent();n.prepend("<div class='lines' style='width:50px'></div>");var a=n.find(".lines");a.height(e.height()+6);a.append("<div class='codelines'></div>");var r=a.find(".codelines");s=f(r,a.height(),1);if(o.selectedLine!=-1&&!isNaN(o.selectedLine)){var d=parseInt(e.height()/(s-2));var l=parseInt(d*o.selectedLine)-e.height()/2;e[0].scrollTop=l}var c=a.outerWidth();var h=parseInt(n.css("border-left-width"))+parseInt(n.css("border-right-width"))+parseInt(n.css("padding-left"))+parseInt(n.css("padding-right"));var v=i-h;var p=i-c-h-20;e.width(p);n.width(v);e.scroll(function(e){var i=g(this)[0];var t=i.scrollTop;var n=i.clientHeight;r.css({"margin-top":-1*t+"px"});s=f(r,t+n,s)});e.resize(function(e){var i=g(this)[0];a.height(i.clientHeight+6)})})};g.fn.linedtextarea.defaults={selectedLine:-1,selectedClass:"lineselect"}})(jQuery);